/** @license MIT - N3.js 0.11.2 (browser build) - Â©Ruben Verborgh */
!function(p){var i,t;i="http://www.w3.org/2001/XMLSchema#"+"double",t={isIRI:function(e){if("string"!=typeof e)return!1;if(0===e.length)return!0;var t=e[0];return'"'!==t&&"_"!==t},isLiteral:function(e){return"string"==typeof e&&'"'===e[0]},isBlank:function(e){return"string"==typeof e&&"_:"===e.substr(0,2)},isDefaultGraph:function(e){return!e},inDefaultGraph:function(e){return!e.graph},getLiteralValue:function(e){var t=/^"([^]*)"/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]},getLiteralType:function(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")},getLiteralLanguage:function(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""},isPrefixedName:function(e){return"string"==typeof e&&/^[^:\/"']*:[^:\/"']+$/.test(e)},expandPrefixedName:function(e,t){var i,r,s,n=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return n&&(r=t[i=n[1]],s=n.index),void 0===r?e:0===s?r+e.substr(i.length+1):e.substr(0,s+3)+r+e.substr(s+i.length+4)},createIRI:function(e){return e&&'"'===e[0]?t.getLiteralValue(e):e},createLiteral:function(e,t){if(!t)switch(typeof e){case"boolean":t="http://www.w3.org/2001/XMLSchema#boolean";break;case"number":isFinite(e)?t=e%1==0?"http://www.w3.org/2001/XMLSchema#integer":i:(t=i,isNaN(e)||(e=0<e?"INF":"-INF"));break;default:return'"'+e+'"'}return'"'+e+(/^[a-z]+(-[a-z0-9]+)*$/i.test(t)?'"@'+t.toLowerCase():'"^^'+t)},prefix:function(e){return t.prefixes({"":e})("")},prefixes:function(e){var r=Object.create(null);for(var t in e)i(t,e[t]);function i(e,t){if(t||!(e in r)){var i=Object.create(null);t=t||"",r[e]=function(e){return i[e]||(i[e]=t+e)}}return r[e]}return i}},p.Util=t,function(){var a=String.fromCharCode,n="function"==typeof setImmediate?setImmediate:function(e){setTimeout(e,0)},t=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,u={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},x=/[\x00-\x20<>\\"\{\}\|\^\`]/;function i(e){if(!(this instanceof i))return new i(e);if((e=e||{}).lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var r=this;this._tokenize=this.tokenize,this.tokenize=function(e,i){this._tokenize(e,function(e,t){!e&&/^(?:IRI|blank|literal|langcode|typeIRI|\.|eof)$/.test(t.type)?i&&i(e,t):i&&i(e||r._syntaxError(t.type,i=null))})}}this._n3Mode=!1!==e.n3,this._comments=!!e.comments}i.prototype={_iri:/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,_unescapedString:/^"[^"\\\r\n]+"/,_singleQuotedString:/^"(?:[^"\\\r\n]|\\.)*"(?=[^"])|^'(?:[^'\\\r\n]|\\.)*'(?=[^'])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,_variable:/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/i,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_comment:/#([^\n\r]*)/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(t,e){for(var i=this._input,r=this._comments;;){for(var s,n;s=this._newline.exec(i);)r&&(n=this._comment.exec(s[0]))&&t(null,{line:this._line,type:"comment",value:n[1],prefix:""}),i=i.substr(s[0].length,i.length),this._line++;if((s=this._whitespace.exec(i))&&(i=i.substr(s[0].length,i.length)),this._endOfFile.test(i))return e&&(r&&(n=this._comment.exec(i))&&t(null,{line:this._line,type:"comment",value:n[1],prefix:""}),t(i=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=i;var a,u=this._line,c="",h="",f="",o=i[0],_=null,d=0,l=!1;switch(o){case"^":if(i.length<3)break;if("^"!==i[1]){this._n3Mode&&(d=1,c="^");break}if(this._previousMarker="^^","<"!==(i=i.substr(2))[0]){l=!0;break}case"<":if(_=this._unescapedIri.exec(i))c="IRI",h=_[1];else if(_=this._iri.exec(i)){if(null===(a=this._unescape(_[1]))||x.test(a))return b(this);c="IRI",h=a}else this._n3Mode&&1<i.length&&"="===i[1]&&(c="inverse",d=2,h="http://www.w3.org/2000/10/swap/log#implies");break;case"_":((_=this._blank.exec(i))||e&&(_=this._blank.exec(i+" ")))&&(c="blank",f="_",h=_[1]);break;case'"':case"'":if(_=this._unescapedString.exec(i))c="literal",h=_[0];else if(_=this._singleQuotedString.exec(i)){if(null===(a=this._unescape(_[0])))return b(this);c="literal",h=a.replace(/^'|'$/g,'"')}else if(_=this._tripleQuotedString.exec(i)){if(a=_[1]||_[2],this._line+=a.split(/\r\n|\r|\n/).length-1,null===(a=this._unescape(a)))return b(this);c="literal",h=a.replace(/^'|'$/g,'"')}break;case"?":this._n3Mode&&(_=this._variable.exec(i))&&(c="var",h=_[0]);break;case"@":"literal"===this._previousMarker&&(_=this._langcode.exec(i))?(c="langcode",h=_[1]):(_=this._keyword.exec(i))&&(c=_[0]);break;case".":if(1===i.length?e:i[1]<"0"||"9"<i[1]){c=".",d=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(_=this._number.exec(i)||e&&(_=this._number.exec(i+" ")))&&(c="literal",h='"'+_[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(_[1]?"double":/^[+\-]?\d+$/.test(_[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(_=this._sparqlKeyword.exec(i))?c=_[0].toUpperCase():l=!0;break;case"f":case"t":(_=this._boolean.exec(i))?(c="literal",h='"'+_[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):l=!0;break;case"a":(_=this._shortPredicates.exec(i))?(c="abbreviation",h="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):l=!0;break;case"=":this._n3Mode&&1<i.length&&(c="abbreviation",">"!==i[1]?(d=1,h="http://www.w3.org/2002/07/owl#sameAs"):(d=2,h="http://www.w3.org/2000/10/swap/log#implies"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":d=1,c=o;break;default:l=!0}if(l&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(_=this._prefix.exec(i))?((_=this._prefixed.exec(i))||e&&(_=this._prefixed.exec(i+" ")))&&(c="prefixed",f=_[1]||"",h=this._unescape(_[2])):(c="prefix",h=_[1]||"")),"^^"===this._previousMarker)switch(c){case"prefixed":c="type";break;case"IRI":c="typeIRI";break;default:c=""}if(!c)return e||!/^'''|^"""/.test(i)&&/\n|\r/.test(i)?b(this):this._input=i;var p={line:u,type:c,value:h,prefix:f};t(null,p),this.previousToken=p,this._previousMarker=c,i=i.substr(d||_[0].length,i.length)}function b(e){t(e._syntaxError(/^\S*/.exec(i)[0]))}},_unescape:function(e){try{return e.replace(t,function(e,t,i,r){var s;if(t){if(s=parseInt(t,16),isNaN(s))throw new Error;return a(s)}if(i){if(s=parseInt(i,16),isNaN(s))throw new Error;return s<=65535?a(s):a(55296+(s-=65536)/1024,56320+(1023&s))}var n=u[r];if(!n)throw new Error;return n})}catch(e){return null}},_syntaxError:function(e){this._input=null;var t=new Error('Unexpected "'+e+'" on line '+this._line+".");return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t},tokenize:function(e,t){var i=this;if(this._line=1,"string"==typeof e){if(this._input=e,"function"!=typeof t){var r,s=[];if(this._tokenizeToEnd(function(e,t){e?r=e:s.push(t)},!0),r)throw r;return s}n(function(){i._tokenizeToEnd(t,!0)})}else this._input="","function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",function(e){null!==i._input&&(i._input+=e,i._tokenizeToEnd(t,!1))}),e.on("end",function(){null!==i._input&&i._tokenizeToEnd(t,!0)}),e.on("error",t)}},p.Lexer=i}(),function(){var c=p.Lexer,e="http://www.w3.org/1999/02/22-rdf-syntax-ns#",h=e+"nil",f=e+"first",o=e+"rest",i="urn:n3:quantifiers",s=/^[a-z][a-z0-9+.-]*:/i,r=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,u=/(?:^|\/)\.\.?(?:$|[\/#?])/,a=0,_=0;function d(e){if(!(this instanceof d))return new d(e);this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.documentIRI);var t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",i="turtle"===t,r="trig"===t,s=/triple/.test(t),n=/quad/.test(t),a=this._n3Mode=/n3/.test(t),u=s||n;(this._supportsNamedGraphs=!(i||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(i||r||s||a),u&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=l,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new c({lineMode:u,n3:a}),this._explicitQuantifiers=!!e.explicitQuantifiers}function l(){}d._resetBlankNodeIds=function(){a=_=0},d.prototype={_setBase:function(e){if(e){var t=e.indexOf("#");0<=t&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(r),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base=null},_saveContext:function(e,t,i,r,s){var n=this._n3Mode;this._contextStack.push({subject:i,predicate:r,object:s,graph:t,type:e,inverse:!!n&&this._inversePredicate,blankPrefix:n?this._prefixes._:"",quantified:n?this._quantified:null}),n&&(this._inversePredicate=!1,this._prefixes._=this._graph+".",this._quantified=Object.create(this._quantified))},_restoreContext:function(){var e=this._contextStack.pop(),t=this._n3Mode;this._subject=e.subject,this._predicate=e.predicate,this._object=e.object,this._graph=e.graph,t&&(this._inversePredicate=e.inverse,this._prefixes._=e.blankPrefix,this._quantified=e.quantified)},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readEntity:function(e,t){var i;switch(e.type){case"IRI":case"typeIRI":i=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);break;case"type":case"blank":case"prefixed":var r=this._prefixes[e.prefix];if(void 0===r)return this._error('Undefined prefix "'+e.prefix+':"',e);i=r+e.value;break;case"var":return e.value;default:return this._error("Expected entity but got "+e.type,e)}return!t&&this._n3Mode&&i in this._quantified&&(i=this._quantified[i]),i},_readSubject:function(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject="_:b"+_++,null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,h,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph="_:b"+_++,null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forSome",this._quantifiedPrefix="_:b",this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forAll",this._quantifiedPrefix="?b-",this._readQuantifierList):this._error('Unexpected "@forAll"',e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject},_readObject:function(e){switch(e.type){case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject="_:b"+_++),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,h),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph="_:b"+_++),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph);var t=null===this._predicate;return this._restoreContext(),null===this._object?t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()},_readPredicateAfterBlank:function(e){return"."!==e.type||this._contextStack.length?this._readPredicate(e):(this._subject=null,this._readPunctuation(e))},_readListItem:function(e){var t=null,i=null,r=this._subject,s=this._contextStack,n=s[s.length-1],a=this._readListItem,u=!0;switch(e.type){case"[":this._saveContext("blank",this._graph,i="_:b"+_++,f,this._subject=t="_:b"+_++),a=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,i="_:b"+_++,f,h),this._subject=null;break;case")":if(this._restoreContext(),0!==s.length&&"list"===s[s.length-1].type&&this._triple(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(a=this._readPredicate,this._subject===h)return a}else if(a=this._getContextEndReader(),this._object===h)return a;i=h;break;case"literal":t=e.value,u=!1,a=this._readListItemDataTypeOrLang;break;default:if(void 0===(t=this._readEntity(e)))return}if(null===i&&(this._subject=i="_:b"+_++),null===r?null===n.predicate?n.subject=i:n.object=i:this._triple(r,o,i,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,i,f,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);u?this._triple(i,f,t,this._graph):this._object=t}return a},_readDataTypeOrLang:function(e){return this._completeLiteral(e,!1)},_readListItemDataTypeOrLang:function(e){return this._completeLiteral(e,!0)},_completeLiteral:function(e,t){var i=!1;switch(e.type){case"type":case"typeIRI":i=!0,this._object+="^^"+this._readEntity(e);break;case"langcode":i=!0,this._object+="@"+e.value.toLowerCase()}return t&&this._triple(this._subject,f,this._object,this._graph),i?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(e))},_readFormulaTail:function(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())},_readPunctuation:function(e){var t,i=this._subject,r=this._graph,s=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,s&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(r=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error('Expected punctuation to follow "'+this._object+'"',e)}if(null!==i){var n=this._predicate,a=this._object;s?this._triple(a,n,i,r):this._triple(i,n,a,r)}return t},_readBlankNodePunctuation:function(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._triple(this._subject,this._predicate,this._object,this._graph),t},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){if("IRI"!==e.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',e);var t=this._readEntity(e);return this._prefixes[this._prefix]=t,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation},_readBaseIRI:function(e){return"IRI"!==e.type?this._error("Expected IRI to follow base declaration",e):(this._setBase(null===this._base||s.test(e.value)?e.value:this._resolveIRI(e)),this._readDeclarationPunctuation)},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+_++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_readQuantifierList:function(e){var t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error("Unexpected "+e.type,e)}return this._explicitQuantifiers?(null===this._subject?this._triple(this._graph||"",this._predicate,this._subject="_:b"+_++,i):this._triple(this._subject,o,this._subject="_:b"+_++,i),this._triple(this._subject,f,t,i)):this._quantified[t]=this._quantifiedPrefix+_++,this._readQuantifierPunctuation},_readQuantifierPunctuation:function(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._triple(this._subject,o,h,i),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))},_getPathReader:function(e){return this._afterPath=e,this._readPath},_readPath:function(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:var t=this._contextStack,i=t.length&&t[t.length-1];if(i&&"item"===i.type){var r=this._subject;this._restoreContext(),this._triple(this._subject,f,r,this._graph)}return this._afterPath(e)}},_readForwardPath:function(e){var t,i,r="_:b"+_++;if(void 0!==(i=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=r):(t=this._object,this._object=r),this._triple(t,i,r,this._graph),this._readPath},_readBackwardPath:function(e){var t,i,r="_:b"+_++;if(void 0!==(t=this._readEntity(e)))return null===this._predicate?(i=this._subject,this._subject=r):(i=this._object,this._object=r),this._triple(r,t,i,this._graph),this._readPath},_getContextEndReader:function(){var e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail}},_triple:function(e,t,i,r){this._callback(null,{subject:e,predicate:t,object:i,graph:r||""})},_error:function(e,t){var i=new Error(e+" on line "+t.line+".");i.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(i)},_resolveIRI:function(e){var t=e.value;switch(t[0]){case void 0:return this._base;case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return this._removeDotSegments(this._basePath+t)}},_removeDotSegments:function(e){if(!u.test(e))return e;for(var t="",i=e.length,r=-1,s=-1,n=0,a="/";r<i;){switch(a){case":":if(s<0&&"/"===e[++r]&&"/"===e[++r])for(;(s=r+1)<i&&"/"!==e[s];)r=s;break;case"?":case"#":r=i;break;case"/":if("."===e[r+1])switch(a=e[++r+1]){case"/":t+=e.substring(n,r-1),n=r+1;break;case void 0:case"?":case"#":return t+e.substring(n,r)+e.substr(r+1);case".":if(void 0===(a=e[++r+1])||"/"===a||"?"===a||"#"===a){if((n=(t+=e.substring(n,r-2)).lastIndexOf("/"))>=s&&(t=t.substr(0,n)),"/"!==a)return t+"/"+e.substr(r+1);n=r+1}}}a=e[++r]}return t+e.substring(n)},parse:function(e,t,i){var r=this;if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+a+++"_",this._prefixCallback=i||l,this._inversePredicate=!1,this._quantified=Object.create(null),!t){var s,n=[];if(this._callback=function(e,t){e?s=e:t&&n.push(t)},this._lexer.tokenize(e).every(function(e){return r._readCallback=r._readCallback(e)}),s)throw s;return n}this._callback=t,this._lexer.tokenize(e,function(e,t){null!==e?(r._callback(e),r._callback=l):r._readCallback&&(r._readCallback=r._readCallback(t))})}},p.Parser=d}(),function(){var i=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,r=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,s=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,n={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};function a(e,t){if(!(this instanceof a))return new a(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var r="";this._outputStream={write:function(e,t,i){r+=e,i&&i()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}function u(e){var t=n[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}a.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,i,r,s){try{this._graph!==r&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(r?this._encodeIriOrBlankNode(r)+" {\n":"")),this._subject=null,this._graph="["!==r[0]?r:"]"),this._subject===e?this._predicate===t?this._write(", "+this._encodeObject(i),s):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(i),s):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(i),s)}catch(e){s&&s(e)}},_writeTripleLine:function(e,t,i,r,s){delete this._prefixMatch;try{this._write(this.tripleToString(e,t,i,r),s)}catch(e){s&&s(e)}},tripleToString:function(e,t,i,r){return this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(i)+(r?" "+this._encodeIriOrBlankNode(r)+".\n":".\n")},triplesToString:function(e){return e.map(function(e){return this.tripleToString(e.subject,e.predicate,e.object,e.graph)},this).join("")},_encodeIriOrBlankNode:function(e){var t=e[0];if("["===t||"("===t||"_"===t&&":"===e[1])return e;r.test(e)&&(e=e.replace(s,u));var i=this._prefixRegex.exec(e);return i?i[1]?this._prefixIRIs[i[1]]+i[2]:e:"<"+e+">"},_encodeLiteral:function(e,t,i){return r.test(e)&&(e=e.replace(s,u)),i?'"'+e+'"@'+i:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw new Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw new Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=i.exec(e);if(!t)throw new Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,i,r,s){void 0===i?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof r?this._writeTriple(e,t,i,"",r):this._writeTriple(e,t,i,r,s)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,i){var r={};r[e]=t,this.addPrefixes(r,i)},addPrefixes:function(e,t){var i=this._prefixIRIs,r=!1;for(var s in e){var n=e[s];/[#\/]$/.test(n)&&i[n]!==(s+=":")&&(r=!0,i[n]=s,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+s+" <"+n+">.\n"))}if(r){var a="",u="";for(var c in i)a+=a?"|"+c:c,u+=(u?"|":"")+i[c];a=a.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+u+")[^/]*$|^("+a+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(r?"\n":"",t)},blank:function(e,t){var i,r,s=e;switch(void 0===e?s=[]:"string"==typeof e?s=[{predicate:e,object:t}]:"length"in e||(s=[e]),r=s.length){case 0:return"[]";case 1:if("["!==(i=s[0]).object[0])return"[ "+this._encodePredicate(i.predicate)+" "+this._encodeObject(i.object)+" ]";default:for(var n="[",a=0;a<r;a++)(i=s[a]).predicate===e?n+=", "+this._encodeObject(i.object):(n+=(a?";\n  ":"\n  ")+this._encodePredicate(i.predicate)+" "+this._encodeObject(i.object),e=i.predicate);return n+"\n]"}},list:function(e){for(var t=e&&e.length||0,i=new Array(t),r=0;r<t;r++)i[r]=this._encodeObject(e[r]);return"("+i.join(" ")+")"},_prefixRegex:/$0^/,end:function(i){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var r=i&&function(e,t){r=null,i(e,t)};if(this._endStream)try{return this._outputStream.end(r)}catch(e){}r&&r()}},p.Writer=a}(),function(){var a=p.Util.expandPrefixedName;function i(e,t){if(!(this instanceof i))return new i(e,t);this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._prefixes=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),e&&this.addTriples(e)}function _(e){return"string"==typeof e||e instanceof String}i.prototype={get size(){var e=this._size;if(null!==e)return e;e=0;var t,i,r=this._graphs;for(var s in r)for(var n in t=r[s].subjects)for(var a in i=t[n])e+=Object.keys(i[a]).length;return this._size=e},_addToIndex:function(e,t,i,r){var s=e[t]||(e[t]={}),n=s[i]||(s[i]={}),a=r in n;return a||(n[r]=null),!a},_removeFromIndex:function(e,t,i,r){var s,n=e[t],a=n[i];for(s in delete a[r],a)return;for(s in delete n[i],n)return;delete e[t]},_findInIndex:function(e,t,i,r,s,n,a,u,c,h){var f,o,_,d=1<!t+!i+!r?Object.keys(this._ids):this._entities;for(var l in t&&((f=e,e={})[t]=f[t]),e){var p=d[l];if(o=e[l])for(var b in i&&((f=o,o={})[i]=f[i]),o){var x=d[b];if(_=o[b])for(var g=(r?r in _?[r]:[]:Object.keys(_)),v=g.length-1;0<=v;v--){var I={subject:"",predicate:"",object:"",graph:u};if(I[s]=p,I[n]=x,I[a]=d[g[v]],h)h.push(I);else if(c(I))return!0}}}return h},_loop:function(e,t){for(var i in e)t(i)},_loopByKey0:function(e,t,i){var r,s;if(r=e[t])for(s in r)i(s)},_loopByKey1:function(e,t,i){var r;for(r in e)e[r][t]&&i(r)},_loopBy2Keys:function(e,t,i,r){var s,n,a;if((s=e[t])&&(n=s[i]))for(a in n)r(a)},_countInIndex:function(e,t,i,r){var s,n,a,u=0;for(var c in t&&((s=e,e={})[t]=s[t]),e)if(n=e[c])for(var h in i&&((s=n,n={})[i]=s[i]),n)(a=n[h])&&(r?r in a&&u++:u+=Object.keys(a).length);return u},_getGraphs:function(e){if(!_(e))return this._graphs;var t={};return t[e]=this._graphs[e],t},_uniqueEntities:function(t){var i=Object.create(null),r=this._entities;return function(e){e in i||(i[e]=!0,t(r[e]))}},addTriple:function(e,t,i,r){t||(r=e.graph,i=e.object,t=e.predicate,e=e.subject),r=r||"";var s=this._graphs[r];s||(s=this._graphs[r]={subjects:{},predicates:{},objects:{}},Object.freeze(s));var n=this._ids,a=this._entities;e=n[e]||(n[a[++this._id]=e]=this._id),t=n[t]||(n[a[++this._id]=t]=this._id),i=n[i]||(n[a[++this._id]=i]=this._id);var u=this._addToIndex(s.subjects,e,t,i);return this._addToIndex(s.predicates,t,i,e),this._addToIndex(s.objects,i,e,t),this._size=null,u},addTriples:function(e){for(var t=e.length-1;0<=t;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,i,r){t||(r=e.graph,i=e.object,t=e.predicate,e=e.subject),r=r||"";var s,n,a,u=this._ids,c=this._graphs;if(!((e=u[e])&&(t=u[t])&&(i=u[i])&&(s=c[r])&&(n=s.subjects[e])&&(a=n[t])&&i in a))return!1;for(e in this._removeFromIndex(s.subjects,e,t,i),this._removeFromIndex(s.predicates,t,i,e),this._removeFromIndex(s.objects,i,e,t),null!==this._size&&this._size--,s.subjects)return!0;return delete c[r],!0},removeTriples:function(e){for(var t=e.length-1;0<=t;t--)this.removeTriple(e[t])},getTriples:function(e,t,i,r){var s=this._prefixes;return this.getTriplesByIRI(a(e,s),a(t,s),a(i,s),a(r,s))},getTriplesByIRI:function(e,t,i,r){var s,n,a,u,c=[],h=this._getGraphs(r),f=this._ids;if(_(e)&&!(n=f[e])||_(t)&&!(a=f[t])||_(i)&&!(u=f[i]))return c;for(var o in h)(s=h[o])&&(n?u?this._findInIndex(s.objects,u,n,a,"object","subject","predicate",o,null,c):this._findInIndex(s.subjects,n,a,null,"subject","predicate","object",o,null,c):a?this._findInIndex(s.predicates,a,u,null,"predicate","object","subject",o,null,c):u?this._findInIndex(s.objects,u,null,null,"object","subject","predicate",o,null,c):this._findInIndex(s.subjects,null,null,null,"subject","predicate","object",o,null,c));return c},countTriples:function(e,t,i,r){var s=this._prefixes;return this.countTriplesByIRI(a(e,s),a(t,s),a(i,s),a(r,s))},countTriplesByIRI:function(e,t,i,r){var s,n,a,u,c=0,h=this._getGraphs(r),f=this._ids;if(_(e)&&!(n=f[e])||_(t)&&!(a=f[t])||_(i)&&!(u=f[i]))return 0;for(var o in h)(s=h[o])&&(c+=e?i?this._countInIndex(s.objects,u,n,a):this._countInIndex(s.subjects,n,a,u):t?this._countInIndex(s.predicates,a,u,n):this._countInIndex(s.objects,u,n,a));return c},forEach:function(e,t,i,r,s){var n=this._prefixes;this.forEachByIRI(e,a(t,n),a(i,n),a(r,n),a(s,n))},forEachByIRI:function(t,e,i,r,s){this.someByIRI(function(e){return t(e),!1},e,i,r,s)},every:function(e,t,i,r,s){var n=this._prefixes;return this.everyByIRI(e,a(t,n),a(i,n),a(r,n),a(s,n))},everyByIRI:function(t,e,i,r,s){var n=!1,a=!this.someByIRI(function(e){return n=!0,!t(e)},e,i,r,s);return n&&a},some:function(e,t,i,r,s){var n=this._prefixes;return this.someByIRI(e,a(t,n),a(i,n),a(r,n),a(s,n))},someByIRI:function(e,t,i,r,s){var n,a,u,c,h=this._getGraphs(s),f=this._ids;if(_(t)&&!(a=f[t])||_(i)&&!(u=f[i])||_(r)&&!(c=f[r]))return!1;for(var o in h)if(n=h[o])if(a){if(c){if(this._findInIndex(n.objects,c,a,u,"object","subject","predicate",o,e,null))return!0}else if(this._findInIndex(n.subjects,a,u,null,"subject","predicate","object",o,e,null))return!0}else if(u){if(this._findInIndex(n.predicates,u,c,null,"predicate","object","subject",o,e,null))return!0}else if(c){if(this._findInIndex(n.objects,c,null,null,"object","subject","predicate",o,e,null))return!0}else if(this._findInIndex(n.subjects,null,null,null,"subject","predicate","object",o,e,null))return!0;return!1},getSubjects:function(e,t,i){var r=this._prefixes;return this.getSubjectsByIRI(a(e,r),a(t,r),a(i,r))},getSubjectsByIRI:function(e,t,i){var r=[];return this.forSubjectsByIRI(function(e){r.push(e)},e,t,i),r},forSubjects:function(e,t,i,r){var s=this._prefixes;this.forSubjectsByIRI(e,a(t,s),a(i,s),a(r,s))},forSubjectsByIRI:function(e,t,i,r){var s,n,a,u=this._ids,c=this._getGraphs(r);if(e=this._uniqueEntities(e),!(_(t)&&!(n=u[t])||_(i)&&!(a=u[i])))for(r in c)(s=c[r])&&(n?a?this._loopBy2Keys(s.predicates,n,a,e):this._loopByKey1(s.subjects,n,e):a?this._loopByKey0(s.objects,a,e):this._loop(s.subjects,e))},getPredicates:function(e,t,i){var r=this._prefixes;return this.getPredicatesByIRI(a(e,r),a(t,r),a(i,r))},getPredicatesByIRI:function(e,t,i){var r=[];return this.forPredicatesByIRI(function(e){r.push(e)},e,t,i),r},forPredicates:function(e,t,i,r){var s=this._prefixes;this.forPredicatesByIRI(e,a(t,s),a(i,s),a(r,s))},forPredicatesByIRI:function(e,t,i,r){var s,n,a,u=this._ids,c=this._getGraphs(r);if(e=this._uniqueEntities(e),!(_(t)&&!(n=u[t])||_(i)&&!(a=u[i])))for(r in c)(s=c[r])&&(n?a?this._loopBy2Keys(s.objects,a,n,e):this._loopByKey0(s.subjects,n,e):a?this._loopByKey1(s.predicates,a,e):this._loop(s.predicates,e))},getObjects:function(e,t,i){var r=this._prefixes;return this.getObjectsByIRI(a(e,r),a(t,r),a(i,r))},getObjectsByIRI:function(e,t,i){var r=[];return this.forObjectsByIRI(function(e){r.push(e)},e,t,i),r},forObjects:function(e,t,i,r){var s=this._prefixes;this.forObjectsByIRI(e,a(t,s),a(i,s),a(r,s))},forObjectsByIRI:function(e,t,i,r){var s,n,a,u=this._ids,c=this._getGraphs(r);if(e=this._uniqueEntities(e),!(_(t)&&!(n=u[t])||_(i)&&!(a=u[i])))for(r in c)(s=c[r])&&(n?a?this._loopBy2Keys(s.subjects,n,a,e):this._loopByKey1(s.objects,n,e):a?this._loopByKey0(s.predicates,a,e):this._loop(s.objects,e))},getGraphs:function(e,t,i){var r=this._prefixes;return this.getGraphsByIRI(a(e,r),a(t,r),a(i,r))},getGraphsByIRI:function(e,t,i){var r=[];return this.forGraphsByIRI(function(e){r.push(e)},e,t,i),r},forGraphs:function(e,t,i,r){var s=this._prefixes;this.forGraphsByIRI(e,a(t,s),a(i,s),a(r,s))},forGraphsByIRI:function(t,e,i,r){for(var s in this._graphs)this.someByIRI(function(e){return t(e.graph),!0},e,i,r,s)},createBlankNode:function(e){var t,i;if(e)for(t=e="_:"+e,i=1;this._ids[t];)t=e+i++;else for(;t="_:b"+this._blankNodeIndex++,this._ids[t];);return this._ids[t]=++this._id,this._entities[this._id]=t}},p.Store=i}()}("undefined"!=typeof exports?exports:this.N3={});